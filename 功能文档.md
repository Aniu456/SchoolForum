# 开放论坛功能文档

> **项目名称**: 开放论坛 (Open Forum)
> **版本**: v1.0.0
> **最后更新**: 2025-11-21

---

## 📋 目录

- [项目概述](#项目概述)
- [核心功能模块](#核心功能模块)
  - [1. 用户认证与管理](#1-用户认证与管理)
  - [2. 帖子管理](#2-帖子管理)
  - [3. 评论与互动](#3-评论与互动)
  - [4. 社交功能](#4-社交功能)
  - [5. 通知系统](#5-通知系统)
  - [6. 搜索功能](#6-搜索功能)
  - [7. 社区服务中心](#7-社区服务中心)
  - [8. 收藏管理](#8-收藏管理)
  - [9. 草稿管理](#9-草稿管理)
  - [10. 公告系统](#10-公告系统)
- [技术架构](#技术架构)
- [特色功能](#特色功能)

---

## 项目概述

开放论坛是一个公益性、开放性的综合社区平台,集成了论坛讨论、社区服务、社交互动等多种功能。项目基于现代化的 React 技术栈构建,提供流畅的用户体验和完善的功能支持。

### 核心定位
- **公益性开放性论坛平台**
- **服务所有用户群体**
- **集论坛讨论与社区服务于一体**

### 技术栈
- **前端框架**: React 19.2.0 + TypeScript 5.x
- **构建工具**: Vite 5.4.0
- **样式方案**: TailwindCSS 4.1.0
- **状态管理**: Zustand 5.0.8
- **数据请求**: TanStack React Query 5.90.7 + Axios 1.7.7
- **路由**: React Router DOM 6.28.0
- **富文本编辑器**: TipTap 3.10.4
- **实时通信**: Socket.IO Client 4.8.1

---

## 核心功能模块

### 1. 用户认证与管理

#### 1.1 用户注册
- 支持邮箱注册
- 填写用户名、昵称、密码
- 自动登录并分配 JWT Token

#### 1.2 用户登录
- 邮箱 + 密码登录
- JWT Token 认证机制
- 支持 Token 自动刷新
- 登录状态持久化(LocalStorage)

#### 1.3 个人资料管理
- 查看个人主页
  - 发帖列表
  - 收藏夹
  - 草稿箱
  - 个人统计(发帖数、点赞数、评论数)
- 编辑个人信息
  - 修改昵称
  - 更新头像
  - 编辑个人简介
- 查看其他用户主页
  - 用户发帖列表
  - 关注/粉丝数
  - 关注用户

#### 1.4 用户角色
本平台所有用户均为普通用户,不区分角色等级,人人平等参与社区讨论。

---

### 2. 帖子管理

#### 2.1 发布帖子
- **富文本编辑器**
  - 支持文本格式化(粗体、斜体、下划线)
  - 支持标题、列表、引用等格式
  - 支持插入图片
  - 支持插入链接
- **标签系统**
  - 添加多个标签
  - 标签用于分类和搜索
- **图片上传**
  - 支持多图上传
  - 图片预览

#### 2.2 浏览帖子
- **首页帖子流**
  - 无限滚动加载
  - 支持多种排序方式
    - 最新发布(latest)
    - 最热门(popular)
    - 趋势(trending)
    - 最多评论(most_commented)
  - 置顶帖子显示
  - 热门标签展示
- **帖子详情**
  - 完整内容展示
  - 查看评论列表
  - 点赞、收藏、分享
  - 查看浏览量、点赞数、评论数
  - 作者信息展示

#### 2.3 编辑与删除
- 编辑自己的帖子
- 删除自己的帖子

#### 2.4 帖子状态
- **PUBLISHED**: 已发布
- **PENDING**: 审核中
- **REJECTED**: 已拒绝
- **DRAFT**: 草稿

---

### 3. 评论与互动

#### 3.1 评论功能
- **一级评论**
  - 对帖子发表评论
  - 支持富文本内容
- **二级回复**
  - 回复其他用户的评论
  - 显示回复对象
  - 支持嵌套显示
- **评论排序**
  - 按时间排序(默认)
  - 按点赞数排序

#### 3.2 点赞功能
- 点赞/取消点赞帖子
- 点赞/取消点赞评论
- 实时更新点赞数
- 显示点赞状态

#### 3.3 互动统计
- 浏览量统计
- 点赞数统计
- 评论数统计
- 收藏数统计

---

### 4. 社交功能

#### 4.1 关注系统
- 关注用户
- 取消关注
- 查看关注列表
- 查看粉丝列表
- 显示关注/粉丝数量

#### 4.2 个性化推荐
- 基于关注的个性化帖子推荐
- 热门话题推荐
- 推荐活跃用户

---

### 5. 通知系统

#### 5.1 通知类型
- **COMMENT**: 有人评论了你的帖子
- **REPLY**: 有人回复了你的评论
- **LIKE**: 有人点赞了你的内容
- **FOLLOW**: 有人关注了你
- **SYSTEM**: 系统通知

#### 5.2 通知管理
- 查看通知列表
- 未读通知计数(实时更新)
- 标记单条通知为已读
- 批量标记所有通知为已读
- 删除通知
- 按类型筛选通知
- 按已读/未读筛选

#### 5.3 实时推送
- **WebSocket 连接**
- 新通知实时推送
- Toast 提示新通知
- 自动更新未读数

---

### 6. 搜索功能

#### 6.1 搜索帖子
- 关键词搜索
- 按标签筛选
- 多种排序方式
  - 相关度(relevance)
  - 发布时间(createdAt)
  - 浏览量(viewCount)
- 分页查询

#### 6.2 搜索用户
- 用户名搜索
- 显示用户信息
  - 头像、昵称
  - 个人简介
  - 发帖数统计

#### 6.3 热门标签
- 展示最受欢迎的标签
- 显示标签使用次数
- 点击标签查看相关帖子

---

### 7. 社区服务中心

社区服务中心是本项目的特色功能,提供了多种实用的社区服务。

#### 7.1 二手交易市场 (Marketplace)
- **发布商品**
  - 商品标题、描述
  - 商品图片
  - 价格、分类
  - 联系方式
- **浏览商品**
  - 商品列表
  - 商品详情
  - 按分类筛选
  - 按价格排序
- **交易管理**
  - 查看自己发布的商品
  - 编辑商品信息
  - 下架/删除商品

#### 7.2 学习资源共享 (Resources)
- **发布资源**
  - 资源标题、描述
  - 资源类型(课件、笔记、题库等)
  - 文件上传/链接
  - 课程信息
- **浏览资源**
  - 资源列表
  - 资源详情
  - 按类型筛选
  - 按评分排序
- **资源评价**
  - 评分系统
  - 评论反馈

#### 7.3 社团招新 (Clubs)
- **发布招新信息**
  - 社团名称、简介
  - 招新要求
  - 社团海报
  - 报名方式
- **浏览社团**
  - 社团列表
  - 社团详情
  - 按类型筛选
- **报名管理**
  - 在线报名
  - 报名状态跟踪

#### 7.4 失物招领 (Lost & Found)
- **发布信息**
  - 失物类型(丢失/拾到)
  - 物品描述
  - 物品图片
  - 丢失/拾到地点
  - 联系方式
- **浏览信息**
  - 失物列表
  - 失物详情
  - 按类型筛选
  - 按时间排序
- **状态管理**
  - 已找到/已归还标记
  - 关闭信息

#### 7.5 拼车拼单 (Carpool)
- **发布拼车信息**
  - 出发地/目的地
  - 出发时间
  - 可拼人数
  - 费用分摊
  - 联系方式
- **浏览拼车信息**
  - 拼车列表
  - 拼车详情
  - 按路线筛选
  - 按时间筛选
- **拼车管理**
  - 参与拼车
  - 取消参与
  - 关闭拼车

---

### 8. 收藏管理

#### 8.1 收藏夹功能
- **创建收藏夹**
  - 收藏夹名称
  - 收藏夹描述
  - 默认收藏夹
- **管理收藏夹**
  - 编辑收藏夹信息
  - 删除收藏夹
  - 查看收藏夹列表

#### 8.2 收藏帖子
- 收藏到指定收藏夹
- 查看收藏的帖子
- 取消收藏
- 移动收藏到其他收藏夹

---

### 9. 草稿管理

#### 9.1 自动保存
- 编辑帖子时自动保存草稿
- 避免内容丢失

#### 9.2 草稿管理
- 查看草稿列表
- 继续编辑草稿
- 从草稿发布帖子
- 删除草稿

---

### 10. 公告系统

#### 10.1 查看公告
- 公告列表展示
- 公告详情页
- 按优先级排序
- 置顶公告显示

#### 10.2 公告类型
- **LOW**: 普通公告
- **NORMAL**: 一般公告
- **HIGH**: 重要公告
- **URGENT**: 紧急公告

---

## 技术架构

### 架构设计

项目采用分层架构设计,职责清晰,易于维护和扩展:

```
┌─────────────────────────────────────────────┐
│                 表现层（UI）               │
│  - src/pages/*                            │
│  - src/components/*                       │
│  - src/routes/index.tsx                   │
└─────────────────────────────────────────────┘
                  ▲
                  │ 使用 Hooks + 组件
                  │
┌─────────────────────────────────────────────┐
│              数据访问 & 状态层             │
│  - src/hooks/*                            │
│  - src/store/*                            │
└─────────────────────────────────────────────┘
                  ▲
                  │ 调用 API / 读取状态
                  │
┌─────────────────────────────────────────────┐
│                 API & 服务层               │
│  - src/api/*                              │
│  - src/services/*                         │
└─────────────────────────────────────────────┘
                  ▲
                  │ HTTP / WebSocket
                  │
┌─────────────────────────────────────────────┐
│              后端服务（REST / WS）         │
└─────────────────────────────────────────────┘
```

### 目录结构

```
src/
├── api/                  # API 接口封装
│   ├── core/            # 核心 HTTP 客户端
│   ├── social/          # 社交相关 API
│   ├── content/         # 内容相关 API
│   └── services/        # 校园服务 API
├── components/          # UI 组件
│   ├── base/           # 基础组件
│   ├── composite/      # 复合组件
│   ├── ui/             # UI 组件库
│   ├── layouts/        # 布局组件
│   ├── guards/         # 路由守卫
│   └── providers/      # Provider 组件
├── pages/              # 页面组件
│   ├── forum/          # 论坛相关页面
│   ├── system/         # 系统页面
│   └── Services/       # 服务中心页面
├── hooks/              # 自定义 Hooks
├── store/              # 全局状态
├── services/           # 前端服务层
├── routes/             # 路由配置
├── types/              # TypeScript 类型
├── utils/              # 工具函数
└── config/             # 配置文件
```

### 核心技术特性

#### 1. 状态管理
- **Zustand**: 轻量级状态管理
  - 认证状态(useAuthStore)
  - UI 状态(useUIStore)
- **React Query**: 服务端状态管理
  - 数据缓存
  - 自动重新请求
  - 乐观更新

#### 2. 路由管理
- **React Router**: 客户端路由
  - 懒加载路由
  - 路由守卫
  - 404 处理

#### 3. 数据请求
- **Axios**: HTTP 客户端
  - 请求/响应拦截器
  - Token 自动注入
  - 错误统一处理
- **React Query Hooks**: 数据请求 Hooks
  - 无限滚动加载
  - 分页查询
  - 数据缓存

#### 4. 实时通信
- **Socket.IO Client**: WebSocket 连接
  - 实时通知推送
  - 自动重连
  - 心跳机制

#### 5. 富文本编辑
- **TipTap**: 富文本编辑器
  - 文本格式化
  - 图片插入
  - 链接插入
  - 扩展性强

#### 6. 样式方案
- **TailwindCSS**: 原子化 CSS
  - 响应式设计
  - 暗色模式支持
  - 自定义主题

---

## 特色功能

### 1. 无限滚动加载
- 首页帖子流支持无限滚动
- 自动加载下一页
- 加载状态提示
- 优化性能,避免重复渲染

### 2. 实时通知推送
- WebSocket 实时连接
- 新通知实时推送到客户端
- Toast 提示新通知
- 自动更新未读数

### 3. 响应式设计
- 支持移动端、平板、桌面端
- 自适应布局
- 触摸友好的交互

### 4. 暗色模式
- 支持明暗主题切换
- 跟随系统主题(可选)
- 护眼模式

### 5. 草稿自动保存
- 编辑帖子时自动保存草稿
- 避免意外关闭导致内容丢失
- 支持从草稿恢复

### 6. 图片上传与预览
- 支持多图上传
- 图片拖拽上传
- 实时预览
- 图片压缩

### 7. 热门标签
- 自动统计热门标签
- 标签云展示
- 点击标签筛选帖子

### 8. 帖子置顶
- 重要帖子可以置顶
- 置顶帖子在首页优先展示

### 9. 智能搜索
- 支持全文搜索
- 按标签筛选
- 多种排序方式
- 搜索结果高亮

### 10. 社区服务集成
- 二手交易
- 学习资源共享
- 社团招新
- 失物招领
- 拼车拼单

---

## API 接口

详细的 API 接口文档请参考项目根目录下的 [USER_API.md](./USER_API.md) 文件。

主要接口分类:
- 认证接口(登录、注册、Token 刷新)
- 帖子管理(CRUD、列表、详情)
- 评论管理(CRUD、回复)
- 点赞功能(toggle)
- 用户管理(个人资料、关注)
- 收藏管理(收藏夹、收藏)
- 通知管理(列表、已读、未读数)
- 搜索功能(帖子、用户、标签)
- 公告管理
- 草稿管理
- 推荐功能
- 社区服务接口

---

## 部署说明

### 环境变量配置

在项目根目录创建 `.env` 文件:

```env
VITE_API_BASE_URL=http://your-api-domain.com
VITE_WS_URL=ws://your-api-domain.com
```

### 构建项目

```bash
# 安装依赖
pnpm install

# 开发模式
pnpm dev

# 构建生产版本
pnpm build

# 预览生产版本
pnpm preview
```

### 生产部署建议
- 使用 Nginx 作为反向代理
- 配置 HTTPS
- 启用 Gzip 压缩
- 配置 CDN 加速静态资源
- 配置错误页面
- 配置日志记录

---

## 未来规划

### 功能增强
- [ ] 私信功能
- [ ] 视频上传与播放
- [ ] 表情包系统
- [ ] 打赏功能
- [ ] 活动管理
- [ ] 问卷调查
- [ ] 投票功能
- [ ] 文章专栏

### 性能优化
- [ ] 图片懒加载
- [ ] 代码分割优化
- [ ] PWA 支持
- [ ] 离线缓存

### 用户体验
- [ ] 国际化支持
- [ ] 无障碍访问
- [ ] 键盘快捷键
- [ ] 主题自定义

---

## 联系方式

如有问题或建议,请联系开发团队:
- **项目地址**: [GitHub Repository]
- **问题反馈**: [Issue Tracker]

---

**文档版本**: v1.0.0
**最后更新**: 2025-11-21
**维护团队**: Open Forum Team
